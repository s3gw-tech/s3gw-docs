"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[8080],{509:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>a,default:()=>l,frontMatter:()=>o,metadata:()=>i,toc:()=>c});var s=t(4848),r=t(8453);const o={},a="Metrics",i={id:"metrics",title:"metrics",description:"[//]ignoreRegExp /rgw[-_]\\w+/)",source:"@site/../s3gw/docs/guide/metrics.md",sourceDirName:".",slug:"/metrics",permalink:"/metrics",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"docs",previous:{title:"Advanced usage",permalink:"/advanced-usage"},next:{title:"Troubleshooting the s3gw",permalink:"/troubleshoot-s3gw"}},d={},c=[{value:"Status Frontend",id:"status-frontend",level:2},{value:"Dashboard",id:"dashboard",level:2},{value:"Prometheus Scraping Setup",id:"prometheus-scraping-setup",level:2}];function h(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"metrics",children:"Metrics"}),"\n",(0,s.jsxs)(n.p,{children:["S3GW metrics leverage the Ceph ",(0,s.jsx)(n.a,{href:"https://docs.ceph.com/en/latest/dev/perf_counters/",children:"Perf\nCounters"})," system\nalready built into RGW."]}),"\n",(0,s.jsx)(n.p,{children:"On top of Perf Counters we export additional 1D Prometheus-style\nhistograms (Ceph's histograms are 2D) using a built in Prometheus\nendpoint part of the status frontend."}),"\n",(0,s.jsxs)(n.p,{children:["The prometheus endpoint implementation is separate from ",(0,s.jsx)(n.a,{href:"https://github.com/digitalocean/ceph_exporter",children:"Ceph\nExporter"})," or the Ceph\nMgr ",(0,s.jsx)(n.a,{href:"https://docs.ceph.com/en/latest/mgr/prometheus/",children:"Prometheus\nModule"}),"."]}),"\n",(0,s.jsx)(n.h2,{id:"status-frontend",children:"Status Frontend"}),"\n",(0,s.jsxs)(n.p,{children:["s3gw supports an additional RGW frontend ",(0,s.jsx)(n.em,{children:"status"})," offering a read-only\nview into the application's state. The frontend is optional and can be\nactivated aside the beast frontend doing the S3 HTTP."]}),"\n",(0,s.jsxs)(n.p,{children:["Most status frontend pages are text-based and meant for human\nconsumption. An exception is the Prometheus endpoint exporting perf\ncounters as ",(0,s.jsx)(n.a,{href:"https://prometheus.io/docs/instrumenting/exposition_formats/",children:"Prometheus Exposition\nFormat"})]}),"\n",(0,s.jsxs)(n.p,{children:["To enable the status frontend including the Prometheus endpoint, add\nthe ",(0,s.jsx)(n.code,{children:"status"})," frontend to\n",(0,s.jsx)(n.a,{href:"https://docs.ceph.com/en/quincy/radosgw/config-ref/#confval-rgw_frontends",children:(0,s.jsx)(n.code,{children:"rgw_frontends"})}),"\n. On the command line this may look like:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"--rgw-frontends 'beast port=7480, status bind=127.0.0.1 port=9090'\n"})}),"\n",(0,s.jsx)(n.h2,{id:"dashboard",children:"Dashboard"}),"\n",(0,s.jsx)(n.p,{children:"A S3GW dashboard is available on Grafana Hub with ID 19544."}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://grafana.com/grafana/dashboards/19544-s3gw/",children:"Grafana Dashboard"})}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"prometheus-scraping-setup",children:"Prometheus Scraping Setup"}),"\n",(0,s.jsxs)(n.p,{children:["The Prometheus endpoint is available on the status frontend address at ",(0,s.jsx)(n.code,{children:"/prometheus"})]}),"\n",(0,s.jsx)(n.p,{children:"Example configuration:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"scrape_configs:\n  - job_name: 's3gw-status'\n    metrics_path: '/prometheus'\n    static_configs:\n      - targets:\n        - 127.0.0.1:9090\n"})})]})}function l(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>i});var s=t(6540);const r={},o=s.createContext(r);function a(e){const n=s.useContext(o);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),s.createElement(o.Provider,{value:n},e.children)}}}]);